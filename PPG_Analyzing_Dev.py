# region init
patient_data = {}
patient_data = {311252977: {
    'ir_fifo': [296774, 296581, 297094, 296974, 296788, 296614, 296629, 296557, 296587, 296485, 296405, 296444, 296513,
                296498, 296396, 296400, 296400, 296415, 296394, 296417, 296307, 296245, 296235, 296266, 296329, 296191,
                296209, 296171, 296129, 296100, 296015, 296130, 296008, 296044, 296187, 296083, 296053, 296124, 296044,
                295987, 296000, 296027, 295985, 295974, 295931, 295909, 295794, 295793, 295878, 295765, 295764, 295788,
                295720, 295762, 295704, 295715, 295687, 295648, 295703, 295666, 295678, 295627, 295574, 295638, 295592,
                295632, 295624, 295570, 295582, 295448, 295546, 295517, 295467, 295494, 295544, 295591, 295577, 295519,
                295399, 295407, 295471, 295372, 295729, 295779, 295775, 295513, 295224, 295191, 295225, 295103, 295091,
                295074, 295023, 294985, 294993, 294987, 294998, 294978, 295000, 294994, 295085, 295029, 295225, 295144,
                295110, 295096, 295080, 295091, 295024, 294985, 294941, 294910, 294911, 294869, 294834, 294830, 294798,
                294797, 294796, 294816, 294854, 294780, 294832, 294809, 294833, 294733, 294749, 294709, 294679, 294707,
                294614, 294757, 294641, 294631, 294579, 294585, 294639, 294631, 294649, 294681, 294663, 294588, 294615,
                294671, 294652, 294687, 294643, 294670, 294699, 294767, 294696, 294695, 294653, 294654, 294775, 294711,
                294709, 294793, 294796, 294735, 294717, 294767, 294801, 294763, 294750, 294751, 294760, 294744, 294692,
                294707, 294673, 294635, 294695, 294698, 294749, 294785, 294867, 294794, 294766, 294836, 294775, 294891,
                294803, 294821, 294855, 294749, 294820, 294815, 294864, 294842, 294808, 294881, 294868, 294853, 294865,
                294827, 294880, 294877, 294837, 294872, 294848, 294915, 294931, 294934, 294883, 294890, 294868, 294906,
                294951, 294882, 294932, 294919, 294926, 294908, 294971, 295011, 294945, 294979, 294987, 294997, 294988,
                294919, 294936, 294930, 294976, 294963, 294940, 294967, 294895, 294913, 295008, 294908, 294950, 294965,
                294967, 295030, 294976, 294994, 294978, 294981, 295049, 294991, 295076, 295030, 294990, 294960, 295010,
                295017, 295064, 295049, 295046, 295041, 294988, 294991, 295043, 295024, 294980, 295070, 295049, 294982,
                294996, 294959, 294982, 294965, 294965, 294964, 295030, 295073, 294997, 295014, 295034, 295020, 295004,
                295064, 295030, 294998, 295009, 294976, 294958, 294942, 294935, 294918, 294910, 294981, 294915, 294976,
                294926, 294909, 294912, 294833, 294935, 294888, 294943, 294928, 294932, 294882, 294902, 294878, 294875,
                294890, 294933, 294921, 294952, 294907, 294866, 294951, 294920, 294929, 294930, 294968, 294907, 294928,
                294963, 294900, 294887, 294908, 294851, 295012, 294924, 294891, 294884, 294833, 294953, 294866, 294875,
                294869, 294896, 294857, 294808, 294834, 294783, 294844, 294740, 294757, 294873, 294864, 294813, 294773,
                294800, 294829, 294779, 294829, 294891, 294869, 294830, 294766, 294757, 294749, 294827, 294816, 294782,
                294776, 294787, 294840, 294754, 294805, 294804, 294828, 294814, 294786, 294813, 294789, 294670, 294738,
                294730, 294683, 294663, 294670, 294809, 294758, 294730, 294725, 294713, 294728, 294677, 294652, 294701,
                294726, 294733, 294718, 294718, 294697, 294671, 294716, 294693, 294657, 294779, 294762, 294673, 294669,
                294723, 294746, 294714, 294643, 294687, 294665, 294732, 294681, 294686, 294696, 294720, 294681, 294695,
                294720, 294746, 294633, 294709, 294654, 294600, 294598, 294647, 294607, 294710, 294658, 294665, 294644,
                294654, 294622, 294719, 294666, 294718, 294693, 294677, 294690, 294712, 294693, 294716, 294642, 294705,
                294727, 294781, 294698, 294725, 294655, 294697, 294646, 294680, 294658, 294676, 294662, 294673, 294719,
                294695, 294637, 294620, 294645, 294632, 294714, 294680, 294682, 294650, 294678, 294579, 294623, 294607,
                294696, 294685, 294659, 294700, 294696, 294632, 294650, 294704, 294710, 294654, 294663, 294677, 294689,
                294699, 294672, 294632, 294665, 294631, 294672, 294653, 294612, 294632, 294620, 294583, 294547, 294562,
                294530, 294509, 294437, 294467, 294475, 294453, 294493, 294453, 294511, 294574, 294526, 294447, 294512,
                294477, 294501, 294437, 294375, 294580, 294427, 294468, 294518, 294453, 294514, 294459, 294482, 294429,
                294541, 294577, 294516, 294579, 294581, 294556, 294533, 294508, 294513, 294548, 294570, 294558, 294541,
                294518, 294584, 294533, 294547, 294537, 294611, 294568, 294575, 294585, 294555, 294523, 294518, 294548,
                294556, 294585, 294588, 294591, 294585, 294548, 294534, 294534, 294536, 294586, 294630, 294574, 294654,
                294525, 294527, 294468, 294488, 294518, 294541, 294568, 294461, 294457, 294481, 294526, 294454, 294478,
                294506, 294508, 294501, 294506, 294492, 294517, 294448, 294439, 294465, 294471, 294452, 294452, 294418,
                294429, 294380, 294390, 294407, 294318, 294423, 294395, 294340, 294318, 294372, 294317, 294275, 294360,
                294373, 294352, 294332, 294368, 294357, 294277, 294306, 294316, 294334, 294375, 294358, 294359, 294335,
                294343, 294370, 294372, 294349, 294358, 294371, 294401, 294399, 294333, 294373, 294409, 294417, 294389,
                294344, 294424, 294400, 294388, 294371, 294365, 294352, 294350, 294320, 294322, 294338, 294387, 294320,
                294322, 294366, 294295, 294280, 294226, 294319, 294382, 294346, 294326, 294361, 294322, 294320, 294308,
                294298, 294344, 294402, 294366, 294361, 294381, 294429, 294415, 294333, 294417, 294399, 294424, 294425,
                294436, 294438, 294455, 294409, 294430, 294363, 294410, 294455, 294461, 294393, 294396, 294353, 294370,
                294311, 294353, 294411, 294401, 294353, 294279, 294222, 294284, 294251, 294289, 294318, 294330, 294280,
                294278, 294331, 294283, 294242, 294167, 294244, 294353, 294221, 294294, 294227, 294228, 294271, 294285,
                294197, 294226, 294270, 294262, 294203, 294216, 294138, 294165, 294134, 294134, 294144, 294171, 294125,
                294150, 294122, 294057, 294066, 294045, 294095, 294150, 294118, 294059, 294055, 294100, 294100, 294036,
                294007, 294028, 294067, 294096, 294043, 294000, 294057, 293985, 293932, 293995, 294010, 294028, 294005,
                294014, 294002, 293949, 293947, 293940, 293923, 294000, 294009, 294043, 294002, 293924, 293984, 293951,
                293966, 293978, 294060, 294034, 294011, 294021, 293970, 293985, 293891, 293879, 293900, 293951, 293953,
                293908, 293883, 293896, 293844, 293786, 293799, 293920, 293872, 293847, 293858, 293879, 293805, 293748,
                293666, 293744, 293797, 293783, 293747, 293699, 293778, 293740, 293715, 293677, 293706, 293758, 293762,
                293717, 293679, 293694, 293631, 293626, 293641, 293741, 293711, 293648, 293699, 293664, 293639, 293626,
                293598, 293731, 293718, 293686, 293663, 293613, 293597, 293584, 293682, 293678, 293685, 293608, 293636,
                293621, 293595, 293599, 293518, 293629, 293678, 293641, 293595, 293600, 293570, 293551, 293600, 293679,
                293704, 293675, 293719, 293646, 293652, 293650, 293607, 293634, 293658, 293713, 293733, 293708, 293648,
                293635, 293665, 293624, 293620, 293748, 293690, 293691, 293693, 293675, 293674, 293655, 293689, 293643,
                293805, 293760, 293670, 293710, 293688, 293655, 293671, 293678, 293702, 293701, 293688, 293627, 293631,
                293661, 293623, 293583, 293633, 293729, 293696, 293660, 293612, 293652, 293650, 293601, 293629, 293769,
                293642, 293703, 293680, 293659, 293672, 293596, 293611, 293651, 293772, 293693, 293616, 293697, 293642,
                293656, 293626, 293611, 293645, 293682, 293681, 293628, 293647, 293644, 293586, 293601, 293583, 293686,
                293650, 293646, 293577, 293526, 293544, 293521, 293491, 293630, 293576, 293587, 293498, 293502, 293502,
                293522, 293572, 293642, 293600, 293539, 293560, 293531, 293495, 293468, 293577, 293563, 293544, 293509,
                293584, 293580, 293493, 293586, 293582, 293465, 293425, 293324, 293306, 293396, 293412, 293533, 293612,
                293477, 293487, 293442, 293362, 293313, 293236, 293267, 293272, 293202, 293163, 293269, 293185, 293202,
                293235, 293390, 293446, 293301, 293207, 293242, 293308, 293206, 293239, 293279, 293294, 293238, 293206,
                293226, 293190, 293192, 293211, 293124, 293070, 293079, 293148, 293199, 293207, 293194, 293035, 292995,
                293008, 293170, 293071, 293185, 293074, 293142, 293210, 293451, 293305, 293500, 293560, 293708, 293644,
                293448, 293365, 293184, 293306, 293071, 292964, 292888, 292823, 292817, 292811, 292781, 291791, 285784,
                288002, 283005, 280237, 278669, 273739, 270796, 268912, 266942, 264880, 263325, 262869, 262606, 262740,
                261344, 260750],
    'red_fifo': [264718, 264357, 264941, 264689, 264524, 264382, 264340, 264247, 264314, 264160, 264121, 264150, 264129,
                 264272, 264155, 264109, 264106, 264227, 264162, 264144, 264024, 264000, 264045, 263969, 264118, 264028,
                 263985, 263915, 263875, 263842, 263750, 263822, 263830, 263849, 263846, 263873, 263771, 263836, 263755,
                 263709, 263736, 263715, 263676, 263739, 263677, 263637, 263546, 263479, 263559, 263396, 263418, 263376,
                 263419, 263410, 263396, 263354, 263332, 263343, 263353, 263275, 263287, 263282, 263299, 263257, 263331,
                 263317, 263300, 263279, 263341, 263125, 263301, 263320, 263236, 263280, 263392, 263440, 263419, 263375,
                 263322, 263354, 263321, 263295, 263741, 263867, 263856, 263597, 263348, 263304, 263232, 263095, 263078,
                 263101, 263015, 262958, 263027, 263022, 263004, 262999, 263067, 263066, 263205, 263127, 263448, 263294,
                 263213, 263200, 263131, 263099, 263014, 262961, 262899, 262901, 262863, 262864, 262793, 262810, 262780,
                 262806, 262788, 262733, 262764, 262848, 262780, 262702, 262694, 262650, 262621, 262572, 262553, 262563,
                 262436, 262511, 262456, 262405, 262356, 262348, 262390, 262328, 262346, 262285, 262310, 262242, 262218,
                 262269, 262293, 262321, 262211, 262207, 262223, 262249, 262237, 262190, 262215, 262211, 262832, 262790,
                 262734, 262763, 262784, 262721, 262685, 262756, 262733, 262688, 262701, 262670, 262696, 262632, 262565,
                 262579, 262552, 262527, 262479, 262544, 262629, 262578, 262588, 262581, 262529, 262620, 262521, 262601,
                 262538, 262460, 262518, 262458, 262542, 262464, 262472, 262516, 262501, 262495, 262482, 262498, 262468,
                 262465, 262462, 262449, 262484, 262420, 262435, 262463, 262475, 262474, 262417, 262421, 262456, 262441,
                 262444, 262396, 262437, 262393, 262349, 262341, 262443, 262449, 262367, 262388, 262391, 262358, 262365,
                 262333, 262298, 262362, 262341, 262340, 262311, 262331, 262328, 262269, 262272, 262271, 262287, 262295,
                 262295, 262292, 262250, 262241, 262233, 262206, 262304, 262234, 262266, 262223, 262229, 262230, 262178,
                 262186, 262265, 262303, 262290, 262243, 262205, 262208, 262234, 262164, 262203, 262198, 262122, 262118,
                 262108, 262133, 262114, 262085, 262075, 262089, 262144, 262141, 262054, 262089, 262106, 262089, 262088,
                 262048, 262040, 262091, 262056, 262025, 262041, 261951, 261908, 261924, 261921, 261964, 261937, 261915,
                 261891, 261881, 261829, 261793, 261824, 261850, 261901, 261911, 261854, 261857, 261847, 261835, 261766,
                 261852, 261890, 261885, 261883, 261844, 261856, 261849, 261809, 261806, 261891, 261949, 261885, 261822,
                 261874, 261835, 261847, 261803, 261826, 261923, 261838, 261866, 261783, 261826, 261725, 261731, 261749,
                 261756, 261812, 261761, 261720, 261745, 261702, 261718, 261634, 261675, 261767, 261760, 261701, 261715,
                 261751, 261686, 261593, 261694, 261773, 261811, 261691, 261667, 261584, 261612, 261669, 261669, 261609,
                 261735, 261656, 261597, 261612, 261659, 261651, 261635, 261629, 261615, 261663, 261591, 261561, 261488,
                 261484, 261458, 261369, 261429, 261575, 261520, 261487, 261437, 261494, 261455, 261389, 261346, 261416,
                 261445, 261458, 261468, 261432, 261409, 261308, 261346, 261341, 261351, 261424, 261364, 261298, 261342,
                 261315, 261329, 261277, 261260, 261343, 261233, 261338, 261259, 261265, 261289, 261230, 261210, 261234,
                 261197, 261309, 261208, 261193, 261214, 261032, 261050, 261050, 261068, 261203, 261137, 261125, 261079,
                 261030, 261031, 261066, 261093, 261121, 261154, 261125, 261079, 261122, 261099, 261094, 261021, 261103,
                 261140, 261142, 261080, 261029, 261024, 261053, 261003, 261048, 261024, 261047, 261012, 261035, 260996,
                 261042, 261012, 260951, 261003, 261000, 261056, 261014, 260993, 260962, 260969, 260921, 260928, 261007,
                 260988, 260988, 261005, 261007, 260953, 260932, 260928, 260926, 260983, 260996, 260992, 261001, 260999,
                 260965, 260910, 260981, 260982, 260981, 261017, 260944, 260918, 260893, 260873, 260832, 260787, 260830,
                 260855, 260768, 260663, 260687, 260664, 260681, 260669, 260618, 260725, 260704, 260697, 260682, 260730,
                 260758, 260630, 260582, 260631, 260722, 260655, 260663, 260643, 260640, 260584, 260627, 260614, 260604,
                 260706, 260689, 260676, 260684, 260722, 260673, 260620, 260607, 260690, 260723, 260668, 260733, 260702,
                 260682, 260659, 260662, 260627, 260658, 260741, 260733, 260661, 260668, 260656, 260602, 260635, 260624,
                 260672, 260750, 260680, 260642, 260684, 260663, 260629, 260577, 260628, 260724, 260690, 260638, 260612,
                 260579, 260582, 260485, 260464, 260525, 260584, 260514, 260468, 260511, 260523, 260450, 260434, 260437,
                 260511, 260492, 260403, 260423, 260444, 260439, 260437, 260399, 260385, 260477, 260424, 260425, 260389,
                 260378, 260321, 260299, 260290, 260264, 260287, 260288, 260290, 260272, 260232, 260215, 260177, 260270,
                 260268, 260263, 260278, 260172, 260203, 260137, 260262, 260210, 260208, 260221, 260235, 260231, 260163,
                 260182, 260206, 260218, 260100, 260125, 260223, 260214, 260203, 260201, 260191, 260256, 260186, 260169,
                 260203, 260314, 260284, 260235, 260175, 260154, 260147, 260128, 260107, 260098, 260225, 260170, 260182,
                 260156, 260118, 260107, 260092, 260069, 260128, 260130, 260137, 260108, 260136, 260068, 260051, 260050,
                 260118, 260098, 260199, 260154, 260152, 260176, 260165, 260163, 260160, 260161, 260234, 260240, 260258,
                 260265, 260280, 260245, 260241, 260221, 260173, 260314, 260302, 260273, 260204, 260203, 260172, 260121,
                 260083, 260153, 260260, 260175, 260100, 260079, 260039, 260061, 259996, 260035, 260116, 260112, 260097,
                 260053, 260101, 260059, 259984, 259956, 260032, 260126, 260061, 260006, 260022, 260054, 260053, 260050,
                 259996, 260041, 260115, 260031, 260020, 259959, 259961, 259933, 259883, 259873, 259949, 259944, 259926,
                 259855, 259865, 259835, 259790, 259807, 259839, 259951, 259924, 259836, 259847, 259833, 259778, 259809,
                 259718, 259785, 259853, 259831, 259781, 259758, 259705, 259725, 259695, 259733, 259785, 259796, 259736,
                 259726, 259737, 259739, 259682, 259620, 259665, 259773, 259763, 259724, 259663, 259689, 259680, 259642,
                 259656, 259689, 259817, 259750, 259775, 259741, 259675, 259607, 259517, 259591, 259677, 259654, 259612,
                 259583, 259596, 259540, 259504, 259465, 259515, 259631, 259562, 259527, 259570, 259583, 259507, 259404,
                 259399, 259416, 259482, 259459, 259435, 259431, 259399, 259339, 259388, 259306, 259361, 259390, 259379,
                 259310, 259320, 259335, 259255, 259191, 259256, 259414, 259335, 259313, 259291, 259223, 259266, 259140,
                 259217, 259321, 259341, 259264, 259216, 259230, 259221, 259193, 259218, 259299, 259331, 259318, 259173,
                 259256, 259226, 259218, 259090, 259262, 259351, 259275, 259198, 259206, 259223, 259168, 259213, 259218,
                 259325, 259379, 259365, 259314, 259307, 259286, 259256, 259279, 259397, 259394, 259350, 259325, 259339,
                 259294, 259306, 259237, 259298, 259438, 259372, 259333, 259323, 259313, 259386, 259341, 259296, 259351,
                 259425, 259404, 259438, 259370, 259336, 259332, 259324, 259255, 259353, 259401, 259345, 259297, 259324,
                 259272, 259211, 259204, 259229, 259410, 259327, 259315, 259355, 259299, 259277, 259156, 259268, 259425,
                 259314, 259296, 259368, 259304, 259308, 259245, 259214, 259295, 259419, 259343, 259331, 259272, 259321,
                 259317, 259236, 259213, 259274, 259326, 259294, 259251, 259307, 259234, 259223, 259215, 259191, 259254,
                 259313, 259255, 259183, 259181, 259165, 259109, 259126, 259319, 259294, 259192, 259194, 259165, 259068,
                 259145, 259265, 259394, 259398, 259296, 259285, 259266, 259240, 259289, 259369, 259383, 259397, 259375,
                 259365, 259351, 259324, 259460, 259480, 259275, 259284, 259187, 259138, 259232, 259276, 259465, 259478,
                 259465, 259428, 259382, 259338, 259228, 259170, 259243, 259201, 259119, 259038, 259212, 259136, 259105,
                 259150, 259401, 259410, 259374, 259236, 259261, 259296, 259189, 259320, 259327, 259331, 259296, 259324,
                 259335, 259248, 259215, 259286, 259224, 259123, 259114, 259220, 259216, 259203, 259177, 259094, 259050,
                 259080, 259242, 259046, 259207, 259105, 259165, 259245, 259585, 259416, 259613, 259766, 259887, 259855,
                 259581, 259498, 259292, 259382, 259124, 258997, 258904, 258872, 258817, 258821, 258721, 257484, 250223,
                 252811, 246968, 244083, 242393, 236256, 233085, 231044, 229341, 227110, 225447, 224908, 224639, 224220,
                 222723, 222056],
    'ir_peaks': [2, 6, 8, 12, 17, 19, 24, 26, 31, 34, 37, 41, 48, 51, 53, 55, 58, 60, 63, 65, 68, 70, 75, 80, 83, 88,
                 94, 96, 98, 100, 102, 107, 112, 120, 122, 124, 126, 129, 131, 136, 139, 143, 145, 149, 154, 158, 162,
                 166, 169, 176, 179, 181, 184, 186, 188, 191, 194, 196, 199, 203, 205, 208, 210, 212, 215, 219, 222,
                 224, 227, 230, 235, 237, 240, 242, 248, 254, 257, 260, 262, 267, 270, 273, 276, 283, 285, 288, 290,
                 292, 294, 296, 300, 302, 305, 309, 312, 315, 317, 322, 324, 326, 329, 331, 334, 339, 342, 348, 353,
                 355, 357, 360, 363, 368, 373, 378, 383, 386, 391, 394, 396, 400, 404, 406, 410, 412, 414, 416, 418,
                 420, 424, 426, 430, 432, 434, 436, 438, 441, 445, 447, 449, 451, 453, 455, 458, 463, 468, 471, 473,
                 476, 480, 485, 487, 490, 493, 495, 498, 501, 503, 505, 508, 511, 517, 521, 523, 525, 528, 536, 543,
                 545, 547, 552, 556, 560, 562, 564, 568, 572, 575, 577, 581, 585, 588, 594, 596, 600, 604, 609, 612,
                 622, 625, 630, 633, 639, 643, 646, 652, 654, 658, 660, 662, 665, 670, 674, 677, 682, 684, 688, 691,
                 694, 696, 700, 702, 705, 708, 718, 721, 726, 728, 736, 739, 743, 746, 748, 753, 756, 760, 764, 769,
                 773, 779, 782, 786, 789, 794, 801, 803, 805, 808, 811, 814, 819, 821, 823, 829, 833, 836, 839, 843,
                 845, 848, 853, 858, 862, 866, 870, 872, 875, 879, 882, 884, 888, 891, 894, 896, 901, 904, 906, 912,
                 915, 919, 923, 926, 935, 937, 943, 946, 951, 955, 959, 962, 965, 971, 976, 978, 982, 986, 991, 1001,
                 1013],
    'red_peaks': [2, 8, 11, 13, 17, 22, 24, 33, 35, 37, 40, 43, 48, 50, 52, 58, 60, 62, 64, 68, 71, 75, 79, 83, 91, 94,
                  98, 100, 102, 111, 113, 115, 117, 121, 129, 131, 136, 138, 140, 145, 149, 152, 154, 158, 161, 164,
                  166, 169, 174, 176, 179, 181, 184, 186, 189, 193, 198, 202, 206, 208, 210, 215, 218, 220, 223, 227,
                  230, 240, 242, 245, 249, 254, 256, 261, 266, 270, 275, 278, 281, 283, 293, 295, 300, 304, 309, 312,
                  314, 317, 319, 321, 326, 329, 331, 334, 338, 343, 351, 355, 360, 368, 372, 379, 383, 386, 389, 391,
                  394, 396, 399, 402, 404, 407, 412, 421, 424, 430, 434, 436, 438, 440, 442, 445, 447, 451, 454, 458,
                  464, 466, 471, 473, 481, 484, 486, 489, 494, 498, 500, 504, 507, 511, 516, 518, 522, 525, 528, 531,
                  534, 537, 542, 547, 551, 555, 559, 563, 568, 570, 579, 584, 587, 589, 591, 595, 600, 603, 608, 612,
                  621, 623, 631, 633, 637, 639, 642, 651, 656, 665, 670, 673, 677, 682, 686, 691, 695, 699, 703, 708,
                  711, 714, 717, 722, 726, 730, 734, 738, 743, 745, 751, 755, 760, 764, 769, 775, 778, 782, 786, 791,
                  795, 798, 803, 806, 811, 815, 820, 827, 831, 833, 836, 841, 845, 847, 854, 857, 862, 865, 870, 873,
                  875, 879, 883, 888, 891, 897, 904, 907, 913, 921, 927, 929, 935, 942, 946, 951, 955, 959, 962, 965,
                  969, 976, 978, 982, 986, 991, 997, 1001]}}
file_path = r'C:\Users\dorony\PycharmProjects\EEE_Final\PPG_EXAMPLE.txt'


# endregion


def read_ppg_data(file_path: str, ppg_data: dict) -> dict:
    """
    Read PPG data from the given file and return a dictionary containing user-specific data.

    Parameters:
        file_path (str): The path to the file containing PPG data.
        ppg_data (dict): A dictionary containing pre-collected user-specific PPG data.
                        The format is: {user_id: {'ir_fifo': [<data>], 'red_fifo': [<data>]}}

    Returns:
        dict: A dictionary containing aggregated user-specific PPG data.
              The format is: {user_id: {'ir_fifo': [<data>], 'red_fifo': [<data>]}}

    """

    with open(file_path, 'r') as file:
        for line in file:
            line = line.strip()
            is_data = line[0].isdigit()

            if not is_data:
                continue

            user_id, ir_value, red_value = map(int, line.split())  # extract data
            is_new_user_id = user_id not in ppg_data

            if is_new_user_id:
                ppg_data[user_id] = {'ir_fifo': [], 'red_fifo': []}

            ppg_data[user_id]['ir_fifo'].append(ir_value)
            ppg_data[user_id]['red_fifo'].append(red_value)

    return ppg_data


def detect_peaks(signal: list, threshold: float = 0.5) -> list:
    """
    Basic peak detection algorithm to find peaks in a signal.

    Parameters:
        signal (list): A list containing the PPG signal data.
        threshold (float): The threshold value used to identify peaks. The default value is 0.5.

    Returns:
        list: A list containing the indices of detected peaks in the signal.
    """
    peaks = []
    max_idx = len(signal) - 1

    for i in range(1, max_idx):
        if signal[i] > threshold and signal[i] > signal[i - 1] and signal[i] > signal[i + 1]:
            peaks.append(i)
    return peaks


def main():
    global patient_data
    global file_path

    patient_data = read_ppg_data(file_path, patient_data)
    # region Peak Detection for each user
    for user_id, user_data in patient_data.items():
        ir_fifo = user_data['ir_fifo']
        red_fifo = user_data['red_fifo']

        ir_peaks = detect_peaks(ir_fifo)
        red_peaks = detect_peaks(red_fifo)
        if 'ir_peaks' in user_data:
            ir_peaks = user_data['ir_peaks'] + ir_peaks
        if 'red_peaks' in user_data:
            red_peaks = user_data['red_peaks'] + red_peaks
        user_data['ir_peaks'] = ir_peaks
        user_data['red_peaks'] = red_peaks
    # endregion
    # region Cleanup Analyzed PPG measures
    for user_id in patient_data:
        patient_data[user_id]["ir_fifo"] = []
        patient_data[user_id]["red_fifo"] = []
    # endregion


if __name__ == "__main__":
    main()
